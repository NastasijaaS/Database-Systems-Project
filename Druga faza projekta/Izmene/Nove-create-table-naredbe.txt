CREATE TABLE PRODAJNO_MESTO
(
    ID_MESTA number(3),
    NAZIV varchar2(10) NOT NULL,
    ADRESA varchar2(20) NOT NULL,
    MESTO VARCHAR2(30) NOT NULL
);

ALTER TABLE PRODAJNO_MESTO ADD PRIMARY KEY(ID_MESTA);

--===========================================================

CREATE TABLE ZAPOSLENI
(
    MATICNI_BROJ VARCHAR2(13),
    IME VARCHAR2(20) NOT NULL,
    PREZIME VARCHAR2(20) NOT NULL,
    BROJ_TELEFONA NUMBER(20) NOT NULL,
    DATUM_RODJENJA DATE,
    ADRESA VARCHAR2(30) NOT NULL,
    FARMACEUT_FLAG NUMBER(3)
);

ALTER TABLE ZAPOSLENI ADD PRIMARY KEY(MATICNI_BROJ);

--=============================================================
CREATE TABLE "FARMACEUT" (
    "MATICNI_BROJ" VARCHAR(13) NOT NULL,
    "DIPLOMIRAO" DATE NOT NULL,
    "OBNOVIO_LICENCU" DATE NOT NULL
);

ALTER TABLE FARMACEUT ADD PRIMARY KEY(MATICNI_BROJ);
ALTER TABLE "FARMACEUT" ADD CONSTRAINT "FARMACEUT_FK" FOREIGN KEY ("MATICNI_BROJ") REFERENCES 
"ZAPOSLENI"("MATICNI_BROJ") ENABLE;
--=============================================================

CREATE TABLE RECEPT
(
    SERIJSKI_BROJ number(20),
    LEKAR VARCHAR2(30) NOT NULL,
    DATUM_IZDAVANJA DATE NOT NULL,
    DATUM_REALIZACIJE DATE NOT NULL,
    ID_PRODAJNOG_MESTA NUMBER(10) NOT NULL,
    MATICNI_BROJ_ZAPOSLENOG VARCHAR2(13) NOT NULL
);

ALTER TABLE RECEPT ADD PRIMARY KEY(SERIJSKI_BROJ);
ALTER TABLE RECEPT ADD CONSTRAINT ID_PRODAJNOG_MESTA_FK FOREIGN KEY(ID_PRODAJNOG_MESTA) REFERENCES PRODAJNO_MESTO(ID_MESTA);
ALTER TABLE RECEPT ADD CONSTRAINT MATICNI_BROJ_ZAPOSLENOG_FK FOREIGN KEY(MATICNI_BROJ_ZAPOSLENOG) REFERENCES ZAPOSLENI(MATICNI_BROJ);

CREATE TABLE PROIZVODJAC
(
    NAZIV VARCHAR2(20)
);

ALTER TABLE PROIZVODJAC ADD PRIMARY KEY(NAZIV);

CREATE TABLE TIP_LEKA (
    ID_TIPA NUMBER(15),
    GRUPA VARCHAR2(15) NOT NULL
);


ALTER TABLE TIP_LEKA ADD PRIMARY KEY(ID_TIPA);

CREATE TABLE LEK (
    ID_LEKA NUMBER(15),
    DOZA_ODRASLI VARCHAR2(30) NOT NULL,
    DOZA_DECA VARCHAR2(30) NOT NULL,
    DOZA_TRUDNICE VARCHAR2(30) NOT NULL,
    DEJSTVO VARCHAR2(100) NOT NULL,
    HEMIJSKI_NAZIV VARCHAR(30) NOT NULL,
    NA_RECEPT NUMBER(1) NOT NULL,
    PROCENAT_PARTICIPACIJE NUMBER CONSTRAINT ID_C1 CHECK (PROCENAT_PARTICIPACIJE BETWEEN 0 AND 100) NOT NULL,
    CENA NUMBER(4) NOT NULL,
    NAZIV_PROIZVODJACA VARCHAR(30) NOT NULL,
    GRUPA_LEKA NUMBER(2) NOT NULL,
    KOMERCIJALNI_NAZIV VARCHAR2(30) NOT NULL
);


ALTER TABLE LEK ADD PRIMARY KEY(ID_LEKA);
ALTER TABLE LEK ADD CONSTRAINT NAZIV_PROIZVODJACA_FK FOREIGN KEY(NAZIV_PROIZVODJACA) REFERENCES PROIZVODJAC(NAZIV);
ALTER TABLE LEK ADD CONSTRAINT GRUPA_LEKA_FK FOREIGN KEY(GRUPA_LEKA) REFERENCES TIP_LEKA(ID_TIPA);

CREATE TABLE PAKOVANJE (
    ID_PAKOVANJA NUMBER(3),
    VRSTA_PAKOVANJA VARCHAR2(30) NOT NULL
);

ALTER TABLE PAKOVANJE ADD PRIMARY KEY(ID_PAKOVANJA);

CREATE TABLE PRODAJE_SE (
    ID_PRODAJNOG_MESTA_1 NUMBER(3),
    ID_LEKA_1 NUMBER(15),
    KOLICINA NUMBER(5) NOT NULL
);


ALTER TABLE PRODAJE_SE ADD PRIMARY KEY(ID_PRODAJNOG_MESTA_1, ID_LEKA_1);

ALTER TABLE PRODAJE_SE ADD CONSTRAINT ID_PRODAJNOG_MESTA_1_FK FOREIGN KEY(ID_PRODAJNOG_MESTA_1) REFERENCES PRODAJNO_MESTO(ID_MESTA);
ALTER TABLE PRODAJE_SE ADD CONSTRAINT ID_LEKA_1_FK FOREIGN KEY(ID_LEKA_1) REFERENCES LEK(ID_LEKA);

CREATE TABLE PREPISAN_LEK (
    ID_LEKA_2 NUMBER(15),
    SB_RECEPTA NUMBER(20)
);


ALTER TABLE PREPISAN_LEK ADD PRIMARY KEY(ID_LEKA_2, SB_RECEPTA);

ALTER TABLE PREPISAN_LEK ADD CONSTRAINT ID_LEKA_2_FK FOREIGN KEY(ID_LEKA_2) REFERENCES LEK(ID_LEKA);
ALTER TABLE PREPISAN_LEK ADD CONSTRAINT SB_RECEPTA_FK FOREIGN KEY(SB_RECEPTA) REFERENCES RECEPT(SERIJSKI_BROJ);

CREATE TABLE RADI_U (
    MBR_ZAPOSLENOG VARCHAR2(13),
    ID_PRODAJNOG_MESTA_2 NUMBER(3),
    OD_DATUM DATE NOT NULL,
    DO_DATUM DATE
);


ALTER TABLE RADI_U ADD PRIMARY KEY(MBR_ZAPOSLENOG, ID_PRODAJNOG_MESTA_2);

ALTER TABLE RADI_U ADD CONSTRAINT MBR_ZAPOSLENOG_FK FOREIGN KEY(MBR_ZAPOSLENOG) REFERENCES ZAPOSLENI(MATICNI_BROJ);
ALTER TABLE RADI_U ADD CONSTRAINT ID_PRODAJNOG_MESTA_2_FK FOREIGN KEY(ID_PRODAJNOG_MESTA_2) REFERENCES PRODAJNO_MESTO(ID_MESTA);

CREATE TABLE INDIKACIJE (
    ID_INDIKACIJE NUMBER(5), 
    ID_LEKA_3 NUMBER(15),
    INDIKACIJA VARCHAR2(100)
);


ALTER TABLE INDIKACIJE ADD PRIMARY KEY(ID_INDIKACIJE);
ALTER TABLE INDIKACIJE ADD CONSTRAINT ID_LEKA_3_FK FOREIGN KEY(ID_LEKA_3) REFERENCES LEK(ID_LEKA);


CREATE TABLE KONTRAINDIKACIJE (
    ID_KONTRAINDIKACIJE NUMBER(5),
    ID_LEKA_4 NUMBER(15),
    KONTRAINDIKACIJA VARCHAR2(100)
);

ALTER TABLE KONTRAINDIKACIJE ADD PRIMARY KEY(ID_KONTRAINDIKACIJE);
ALTER TABLE KONTRAINDIKACIJE ADD CONSTRAINT ID_LEKA_4_FK FOREIGN KEY(ID_LEKA_4) REFERENCES LEK(ID_LEKA);

CREATE TABLE UPAKOVAN_U (
    ID_PAKOVANJA_2 NUMBER(3) NOT NULL,
    ID_LEKA_7 NUMBER(15) NOT NULL,
    KOLICINA NUMBER(4) NOT NULL,
    SASTAV VARCHAR2(300) NOT NULL
);

ALTER TABLE UPAKOVAN_U ADD PRIMARY KEY(ID_PAKOVANJA_2, ID_LEKA_7);

ALTER TABLE UPAKOVAN_U ADD CONSTRAINT ID_PAKOVANJA_2_FK FOREIGN KEY(ID_PAKOVANJA_2) REFERENCES PAKOVANJE(ID_PAKOVANJA);
ALTER TABLE UPAKOVAN_U ADD CONSTRAINT ID_LEKA_7_FK FOREIGN KEY(ID_LEKA_7) REFERENCES LEK(ID_LEKA);

